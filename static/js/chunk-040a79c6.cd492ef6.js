(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-040a79c6"],{"495b":function(e,t,a){"use strict";a("e060")},c735:function(e,t,a){"use strict";a.r(t);var r,s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("approveTemplate",{attrs:{coin:"trx",rpc_node:"https://bsc.mytokenpocket.vip/"}})},n=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:"container "+(e.tableData.length>0?"miniContainer":"")},[a("div",{staticClass:"createBox"},[a("div",{staticClass:"boxCenter"},[a("div",{staticClass:"coinIcon"},[a("svg-icon",{style:"color:"+e.coinList[e.form.coin].color,attrs:{"icon-class":e.coinList[e.form.coin].icon}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.coinList[e.form.coin].type,expression:"coinList[form.coin].type"}],staticClass:"radioBox"},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.coinList[e.form.coin].type,(function(t,r){return a("el-radio",{key:t,attrs:{label:r,border:""}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("div",{staticClass:"inputBox"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:e.$t("approve.sleep"),placement:"top"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.address,expression:"form.address"}],staticClass:"input",attrs:{type:"text",placeholder:e.$t("approve.inputPlaceholder")},domProps:{value:e.form.address},on:{input:function(t){t.target.composing||e.$set(e.form,"address",t.target.value)}}})]),a("div",{staticClass:"icon",on:{click:e.onCheck}},[a("i",{class:e.loading?"el-icon-loading":"el-icon-right"})])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.tableData.length,expression:"tableData.length === 0"}],staticClass:"desc"},[a("el-alert",{attrs:{title:e.$t("approve.desc"),type:"success",closable:!1}})],1)])]),a("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],attrs:{"text-inside":!0,"stroke-width":12,percentage:e.percentage}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],staticClass:"scrollBox"},[a("div",{staticClass:"tips"},[a("p",{staticClass:"alertText"},[e._v(e._s(e.$t("approve.alert_text")))]),a("p",{staticClass:"alertText"},[e._v("CoinTool.App")])]),a("el-row",{staticClass:"cardList",attrs:{gutter:20}},e._l(e.tableData,(function(t,r){return a("el-col",{key:r,attrs:{lg:12,xs:24}},[a("div",{staticClass:"card"},[a("div",{staticClass:"coinInfo"},[a("div",{staticClass:"left"},[a("div",{staticClass:"imgBox"},[a("el-image",{staticClass:"img img1",attrs:{src:e.coinList[e.form.coin].logo_link.replace("#address#","bsc"===e.form.coin?t.symbol:t.token_address)}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("img",{staticClass:"img",attrs:{src:"https://cdn.jsdelivr.net/gh/CoinTool-App/cdn/pic/unknown-token.png"}})])])],1),a("div",{staticClass:"sybmol"},[a("a",{staticStyle:{"margin-left":"6px"},attrs:{href:e.coinList[e.form.coin].url+"/#/token20/"+t.token_address+"?a="+e.form.address,target:"_blank"}},[e._v(e._s(t.symbol))])])]),a("div",{staticClass:"right"},[e._v(" "+e._s(e.$t("approve.dangerLevel"))+": "),a("span",{class:"flag "+(1===t.type?"redBg":"greenBg")},[e._v(e._s(1===t.type?e.$t("approve.high"):e.$t("approve.low")))])])]),a("ul",[a("li",[a("p",[a("span",{staticClass:"key"},[e._v(e._s(e.$t("approve.smart_contract"))+":")]),a("a",{attrs:{href:e.coinList[e.form.coin].url+"/#/address/"+t.c_address,target:"_blank"}},[e._v(" "+e._s(e._f("autoAddress")(t.c_address))+" ")])])]),a("li",[a("p",[a("span",{staticClass:"key"},[e._v(e._s(e.$t("approve.token"))+":")]),a("a",{attrs:{href:e.coinList[e.form.coin].url+"/#/token20/"+t.token_address+"?a="+e.form.address,target:"_blank"}},[e._v(" "+e._s(e._f("autoAddress")(t.token_address))+" ")])])]),a("li",[a("p",[a("span",{staticClass:"key"},[e._v(e._s(e.$t("approve.amount"))+":")]),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.amount)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:1===t.type,expression:"item.type===1"}],staticClass:"el-icon-warning",staticStyle:{color:"red"}})])])])]),a("div",{staticClass:"unlockBtn"},[e.form.web3Address===e.form.address?a("el-button",{attrs:{disabled:1===t.status,type:"danger",size:"mini"},on:{click:function(a){return e.closeApprove(r,t)}}},[e._v(e._s(e.$t("approve.decline")))]):a("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.$t("approve.unlock")))])],1)])])})),1)],1)],1)},i=[],c=(a("4b4e"),a("bf2f"),a("529f"),a("27ae"),a("d447"),a("591f"),a("ea94"),a("feb3"),a("96cf"),a("1da1")),l=a("5530"),d=a("023d"),p=a("d01b"),u=a.n(p),m=a("2f62"),f="approve",v="https://api.trongrid.io",g=new u.a({fullHost:v}),h=Object(l["a"])(Object(l["a"])({name:"ApproveTemplate",inject:["tronwalletStateTest"],props:{coin:{type:String,default:"eth"},rpc_node:{type:String,default:""}}},Object(m["b"])(["isPc"])),{},{data:function(){return{loading:!1,donationNum:0,donationChecked:!0,donationOk:!0,donationSybmol:"ETH",form:{coin:"eth",address:"",web3Address:""},tableData:[],coinList:{trx:{icon:"coin-trx",name:"TRON",url:"https://tronscan.io/",logo_link:"https://coin.top/production/logo/#address#.png",color:"#6bb1f1"}},percentage:0}},computed:Object(l["a"])({},Object(m["b"])(["isPc"])),created:function(){this.$i18n.getLocaleMessage("en")[f]||(this.$i18n.mergeLocaleMessage("en",d["a"].en),this.$i18n.mergeLocaleMessage("zh",d["a"].zh)),this.form.coin=this.coin},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.tronwalletStateTest();case 2:r=e,a=e.$route.query.address,setTimeout((function(){try{r.form.web3Address=r.form.address=window.tronWeb.defaultAddress.base58,0!==a.length&&(r.form.address=a)}catch(e){console.log(e)}}),1500);case 5:case"end":return t.stop()}}),t)})))()},methods:{onCheck:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,r,s,n,o,i,c,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.form.address){t.next=3;break}return e.$message.error(e.$t("approve.inputPlaceholder")),t.abrupt("return");case 3:if(e.form.address=e.form.address.trim(),g.isAddress(e.form.address)){t.next=7;break}return e.$message.error(e.$t("approve.addressError")),t.abrupt("return");case 7:return e.tableData=[],e.percentage=0,e.loading=!0,a=[],r=!1,s=!0,t.prev=13,t.next=16,Promise.any([e.checkApi(e.form.address),e.checkApiProxy(e.form.address),e.checkApiProxy1(e.form.address)]);case 16:n=t.sent,console.log(121544444444,n);case 18:if(!s){t.next=51;break}n&&n.meta.fingerprint||(s=!1),t.t0=regeneratorRuntime.keys(n.data);case 21:if((t.t1=t.t0()).done){t.next=49;break}if(o=t.t1.value,"Approval"!==n.data[o].type){t.next=37;break}if(i=n.data[o].to,c=n.data[o].from+i,!a[c]){t.next=28;break}return t.abrupt("continue",21);case 28:if(a[c]=!0,l=e.$t("approve.unlimited"),d=1,p=n.data[o].value,"115792089237316195423570985008687907853269984665640564039457584007913129639935"!==n.data[o].value&&(l=parseFloat(parseInt(p)/Math.pow(10,n.data[o].token_info.decimals)),l.toString().indexOf(".")>-1&&(l=l.toFixed(4)),(l.toString().indexOf("e")>-1||l.toString().indexOf("+")>-1)&&(l="<0.00001"),d=2),0!==l){t.next=35;break}return t.abrupt("continue",21);case 35:r=!0,e.tableData.push({type:d,status:0,symbol:n.data[o].token_info.symbol,token_address:n.data[o].token_info.address,c_address:i,amount:l});case 37:if(parseInt(o)!==n.data.length-1){t.next=47;break}if(!n.meta.fingerprint){t.next=46;break}return t.next=41,new Promise((function(e){return setTimeout(e,1e3)}));case 41:return t.next=43,Promise.any([e.checkApi(e.form.address,n.meta.fingerprint),e.checkApiProxy(e.form.address,n.meta.fingerprint),e.checkApiProxy1(e.form.address,n.meta.fingerprint)]);case 43:n=t.sent,t.next=47;break;case 46:s=!1;case 47:t.next=21;break;case 49:t.next=18;break;case 51:t.next=56;break;case 53:t.prev=53,t.t2=t["catch"](13),console.log(t.t2);case 56:if(r){t.next=60;break}return e.$message({message:e.$t("approve.addressZero")}),e.loading=!1,t.abrupt("return");case 60:e.percentage=100,e.loading=!1;case 62:case"end":return t.stop()}}),t,null,[[13,53]])})))()},closeApprove:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var n,o,i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return a.tableData[e].status=1,s.prev=1,n=[{type:"address",value:t.c_address},{type:"uint256",value:0}],s.next=5,window.tronWeb.transactionBuilder.triggerSmartContract(t.token_address,"approve(address,uint256)",{feeLimit:4e7},n);case 5:return o=s.sent,s.next=8,window.tronWeb.trx.sign(o.transaction);case 8:i=s.sent,window.tronWeb.trx.sendRawTransaction(i).then((function(t){r.tableData.splice(e,1),a.$message({message:a.$t("approve.decline_ok")})})).catch((function(e){console.log("wwwwww",e)})),s.next=15;break;case 12:s.prev=12,s.t0=s["catch"](1),a.tableData[e].status=0;case 15:case"end":return s.stop()}}),s,null,[[1,12]])})))()},checkApi:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s="https://api.trongrid.io/v1/accounts/"+e+"/transactions/trc20?limit=200",t=t?"&fingerprint="+t:"",r.next=4,a.$ajax({url:s+t,method:"get",timeout:1e4});case 4:return n=r.sent,r.abrupt("return",n);case 6:case"end":return r.stop()}}),r)})))()},checkApiProxy:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s="https://api.trongrid.io/v1/accounts/"+e+"/transactions/trc20?limit=200",t=t?"&fingerprint="+t:"",n="https://proxy.cointool.workers.dev/?url="+encodeURIComponent(s+t),r.next=5,a.$ajax({url:n,method:"get",timeout:1e4});case 5:return o=r.sent,r.abrupt("return",o);case 7:case"end":return r.stop()}}),r)})))()},checkApiProxy1:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s,n,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s="https://api.trongrid.io/v1/accounts/"+e+"/transactions/trc20?limit=200",t=t?"&fingerprint="+t:"",n="https://brazen-gamy-weaver.glitch.me/?url="+encodeURIComponent(s+t),r.next=5,a.$ajax({url:n,method:"get",timeout:1e4});case 5:return o=r.sent,r.abrupt("return",o);case 7:case"end":return r.stop()}}),r)})))()}}}),b=h,k=(a("495b"),a("2877")),x=Object(k["a"])(b,o,i,!1,null,"0cbe9758",null),w=x.exports,_={name:"BscApprove",components:{approveTemplate:w}},y=_,C=Object(k["a"])(y,s,n,!1,null,null,null);t["default"]=C.exports},e060:function(e,t,a){}}]);