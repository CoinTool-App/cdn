(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-448c6c4f"],{1616:function(e,t,a){"use strict";a("49402")},49402:function(e,t,a){},c7353:function(e,t,a){"use strict";a.r(t);var s,r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("approveTemplate",{attrs:{coin:"trx",rpc_node:"https://bsc.mytokenpocket.vip/"}})},n=[],o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:"container "+(e.tableData.length>0?"miniContainer":"")},[a("div",{staticClass:"createBox"},[a("div",{staticClass:"boxCenter"},[a("div",{staticClass:"coinIcon"},[a("svg-icon",{style:"color:"+e.coinList[e.form.coin].color,attrs:{"icon-class":e.coinList[e.form.coin].icon}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:e.coinList[e.form.coin].type,expression:"coinList[form.coin].type"}],staticClass:"radioBox"},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},e._l(e.coinList[e.form.coin].type,(function(t,s){return a("el-radio",{key:t,attrs:{label:s,border:""}},[e._v(" "+e._s(t)+" ")])})),1)],1),a("div",{staticClass:"inputBox"},[a("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:e.$t("approve.sleep"),placement:"top"}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.form.address,expression:"form.address"}],staticClass:"input",attrs:{type:"text",placeholder:e.$t("approve.inputPlaceholder")},domProps:{value:e.form.address},on:{input:function(t){t.target.composing||e.$set(e.form,"address",t.target.value)}}})]),a("div",{staticClass:"icon",on:{click:e.onCheck}},[a("i",{class:e.loading?"el-icon-loading":"el-icon-right"})])],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0===e.tableData.length,expression:"tableData.length === 0"}],staticClass:"desc"},[a("el-alert",{attrs:{title:e.$t("approve.desc"),type:"success",closable:!1}})],1)])]),a("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],attrs:{"text-inside":!0,"stroke-width":12,percentage:e.percentage}}),a("div",{directives:[{name:"show",rawName:"v-show",value:e.tableData.length>0,expression:"tableData.length > 0"}],staticClass:"scrollBox"},[a("div",{staticClass:"tips"},[a("p",{staticClass:"alertText"},[e._v(e._s(e.$t("approve.alert_text")))]),a("p",{staticClass:"alertText"},[e._v("CoinTool.App")])]),a("el-row",{staticClass:"cardList",attrs:{gutter:20}},e._l(e.tableData,(function(t,s){return a("el-col",{key:s,attrs:{lg:12,xs:24}},[a("div",{staticClass:"card"},[a("div",{staticClass:"coinInfo"},[a("div",{staticClass:"left"},[a("div",{staticClass:"imgBox"},[a("el-image",{staticClass:"img img1",attrs:{src:e.coinList[e.form.coin].logo_link.replace("#address#","bsc"===e.form.coin?t.symbol:t.token_address)}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[a("img",{staticClass:"img",attrs:{src:"https://cdn.jsdelivr.net/gh/CoinTool-App/cdn/pic/unknown-token.png"}})])])],1),a("div",{staticClass:"sybmol"},[a("a",{staticStyle:{"margin-left":"6px"},attrs:{href:e.coinList[e.form.coin].url+"/#/token20/"+t.token_address+"?a="+e.form.address,target:"_blank"}},[e._v(e._s(t.symbol))])])]),a("div",{staticClass:"right"},[e._v(" "+e._s(e.$t("approve.dangerLevel"))+": "),a("span",{class:"flag "+(1===t.type?"redBg":"greenBg")},[e._v(e._s(1===t.type?e.$t("approve.high"):e.$t("approve.low")))])])]),a("ul",[a("li",[a("p",[a("span",{staticClass:"key"},[e._v(e._s(e.$t("approve.smart_contract"))+":")]),a("a",{attrs:{href:e.coinList[e.form.coin].url+"/#/address/"+t.c_address,target:"_blank"}},[e._v(" "+e._s(e._f("autoAddress")(t.c_address))+" ")])])]),a("li",[a("p",[a("span",{staticClass:"key"},[e._v(e._s(e.$t("approve.token"))+":")]),a("a",{attrs:{href:e.coinList[e.form.coin].url+"/#/token20/"+t.token_address+"?a="+e.form.address,target:"_blank"}},[e._v(" "+e._s(e._f("autoAddress")(t.token_address))+" ")])])]),a("li",[a("p",[a("span",{staticClass:"key"},[e._v(e._s(e.$t("approve.amount"))+":")]),a("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(t.amount)+" "),a("i",{directives:[{name:"show",rawName:"v-show",value:1===t.type,expression:"item.type===1"}],staticClass:"el-icon-warning",staticStyle:{color:"red"}})])])])]),a("div",{staticClass:"unlockBtn"},[e.form.web3Address===e.form.address?a("el-button",{attrs:{disabled:1===t.status,type:"danger",size:"mini"},on:{click:function(a){return e.closeApprove(s,t)}}},[e._v(e._s(e.$t("approve.decline")))]):a("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.$t("approve.unlock")))])],1)])])})),1)],1)],1)},i=[],c=(a("ecb4"),a("ea69"),a("20a5"),a("e18c"),a("1c2e"),a("6db4"),a("af86"),a("6a61"),a("2e91")),l=a("d211"),d=a("023d"),p=a("768a"),u=a.n(p),m=a("52c1"),v="approve",f="https://api.trongrid.io",g=new u.a({fullHost:f}),b=Object(l["a"])(Object(l["a"])({name:"ApproveTemplate",inject:["tronwalletStateTest"],props:{coin:{type:String,default:"eth"},rpc_node:{type:String,default:""}}},Object(m["b"])(["isPc"])),{},{data:function(){return{loading:!1,donationNum:0,donationChecked:!0,donationOk:!0,donationSybmol:"ETH",form:{coin:"eth",address:"",web3Address:""},tableData:[],coinList:{trx:{icon:"coin-trx",name:"TRON",url:"https://tronscan.io/",logo_link:"https://coin.top/production/logo/#address#.png",color:"#6bb1f1"}},percentage:0}},computed:Object(l["a"])({},Object(m["b"])(["isPc"])),created:function(){this.$i18n.getLocaleMessage("en")[v]||(this.$i18n.mergeLocaleMessage("en",d["a"].en),this.$i18n.mergeLocaleMessage("zh",d["a"].zh)),this.form.coin=this.coin},mounted:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.tronwalletStateTest();case 2:s=e,a=e.$route.query.address,setTimeout((function(){try{s.form.web3Address=s.form.address=window.tronWeb.defaultAddress.base58,0!==a.length&&(s.form.address=a)}catch(e){console.log(e)}}),1500);case 5:case"end":return t.stop()}}),t)})))()},methods:{onCheck:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){var a,s,r,n,o,i,c,l,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!==e.form.address){t.next=3;break}return e.$message.error(e.$t("approve.inputPlaceholder")),t.abrupt("return");case 3:if(e.form.address=e.form.address.trim(),g.isAddress(e.form.address)){t.next=7;break}return e.$message.error(e.$t("approve.addressError")),t.abrupt("return");case 7:return e.tableData=[],e.percentage=0,e.loading=!0,a=[],s=!1,r=!0,t.prev=13,t.next=16,e.checkApi(e.form.address);case 16:n=t.sent;case 17:if(!r){t.next=49;break}t.t0=regeneratorRuntime.keys(n.data);case 19:if((t.t1=t.t0()).done){t.next=47;break}if(o=t.t1.value,"Approval"!==n.data[o].type){t.next=35;break}if(i=n.data[o].to,c=n.data[o].from+i,!a[c]){t.next=26;break}return t.abrupt("continue",19);case 26:if(a[c]=!0,l=e.$t("approve.unlimited"),d=1,p=n.data[o].value,"115792089237316195423570985008687907853269984665640564039457584007913129639935"!==n.data[o].value&&(l=parseFloat(parseInt(p)/Math.pow(10,n.data[o].token_info.decimals)),l.toString().indexOf(".")>-1&&(l=l.toFixed(4)),(l.toString().indexOf("e")>-1||l.toString().indexOf("+")>-1)&&(l="<0.00001"),d=2),0!==l){t.next=33;break}return t.abrupt("continue",19);case 33:s=!0,e.tableData.push({type:d,status:0,symbol:n.data[o].token_info.symbol,token_address:n.data[o].token_info.address,c_address:i,amount:l});case 35:if(parseInt(o)!==n.data.length-1){t.next=45;break}if(!n.meta.fingerprint){t.next=44;break}return t.next=39,new Promise((function(e){return setTimeout(e,1e3)}));case 39:return t.next=41,e.checkApi(e.form.address,n.meta.fingerprint);case 41:n=t.sent,t.next=45;break;case 44:r=!1;case 45:t.next=19;break;case 47:t.next=17;break;case 49:t.next=54;break;case 51:t.prev=51,t.t2=t["catch"](13),console.log(t.t2);case 54:if(s){t.next=58;break}return e.$message({message:e.$t("approve.addressZero")}),e.loading=!1,t.abrupt("return");case 58:e.percentage=100,e.loading=!1;case 60:case"end":return t.stop()}}),t,null,[[13,51]])})))()},closeApprove:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var n,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.tableData[e].status=1,r.prev=1,n=[{type:"address",value:t.c_address},{type:"uint256",value:0}],r.next=5,window.tronWeb.transactionBuilder.triggerSmartContract(t.token_address,"approve(address,uint256)",{feeLimit:4e7},n);case 5:return o=r.sent,r.next=8,window.tronWeb.trx.sign(o.transaction);case 8:i=r.sent,window.tronWeb.trx.sendRawTransaction(i).then((function(t){s.tableData.splice(e,1),a.$message({message:a.$t("approve.decline_ok")})})).catch((function(e){console.log("wwwwww",e)})),r.next=15;break;case 12:r.prev=12,r.t0=r["catch"](1),a.tableData[e].status=0;case 15:case"end":return r.stop()}}),r,null,[[1,12]])})))()},checkApi:function(e,t){var a=this;return Object(c["a"])(regeneratorRuntime.mark((function s(){var r,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r="https://api.trongrid.io/v1/accounts/"+e+"/transactions/trc20?limit=200",t=t?"&fingerprint="+t:"",s.next=4,a.$ajax({url:r+t,method:"get",timeout:1e4});case 4:return n=s.sent,s.abrupt("return",n);case 6:case"end":return s.stop()}}),s)})))()}}}),h=b,k=(a("1616"),a("5d22")),w=Object(k["a"])(h,o,i,!1,null,"2c624f0b",null),x=w.exports,_={name:"BscApprove",components:{approveTemplate:x}},y=_,C=Object(k["a"])(y,r,n,!1,null,null,null);t["default"]=C.exports}}]);